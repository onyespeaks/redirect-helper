<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Checking Access...</title>
</head>
<body>
  <p>🔒 Verifying your access. Please wait...</p>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const shortToken = urlParams.get("s");

    const appsScript = "https://script.google.com/macros/s/AKfycbx9AQnyCeQwOPGFoz--XwrnVgMwyeS7Lo8NRT6X91AXGpRc_6Ye-PVUjy5bafDZ3V0e/exec";
    const wixPageBase = "https://www.onyespeaks.com/gettinginvolved";

    if (!shortToken) {
      document.body.innerHTML = "⚠️ Missing token. Please return to your original access point.";
    } else {
      fetch(`${appsScript}?short=${shortToken}`)
        .then(res => res.json())
        .then(data => {
          if (data.token) {
            const fullUrl = `${wixPageBase}?t=${data.token}`;
            window.location.replace(fullUrl);
          } else {
            document.body.innerHTML = "❌ Access denied.";
          }
        })
        .catch(() => {
          document.body.innerHTML = "⚠️ Unable to verify access. Please try again later.";
        });
    }
  </script>
</body>
</html>

